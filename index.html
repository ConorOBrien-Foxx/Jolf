<!DOCTYPE html>
<html lang="en">
<head>
	<title>Jolf</title>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<meta name="description" content="Jolf : A golfier prefix version of JavaScript">
	<link rel="stylesheet" href="bootstrap.css">
	<script type="text/javascript" src="https://rawgit.com/gf3/Levenshtein/master/lib/levenshtein.js"></script>
	<script type="text/javascript" src="https://rawgit.com/mathiasbynens/utf8.js/master/utf8.js"></script>
	<script type="text/javascript" src="https://rawgit.com/davebalmer/turtlewax/master/pen.js"></script>
-	<script type="text/javascript" src="https://rawgit.com/ConorOBrien-Foxx/Jolf/master/src/jolf.js"></script>
	<script type="text/javascript">
	// from tryitonline.net
	function load(){
		if(location.hash){
			var hash = location.hash.slice(1).split("&").map(function(r){
				r=r.split("=");
				if(r[0]=="code") document.getElementById("code").value = decode(r[1]);
				if(r[0]=="input") document.getElementById("input").value = decode(r[1]);
			});
		}
	}

	function save(){
		var a = document.getElementById("code").value;
		var b = document.getElementById("input").value;
		location.hash = "#"+
						[a?"code="+encode(a):"",
						b?"input="+encode(b):""].filter(function(x){return x}).join("&");
	}

	function encode(string) {
		return btoa(unescape(encodeURIComponent(string))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");
	}

	function decode(string) {
		return decodeURIComponent(escape(atob(unescape(string).replace(/-/g, "+").replace(/_/g, "/"))));
	}

	// end from tryitonline.net

	var progs = {
		"Hello World (1)": "\"Hello, World!",
		"Hello World (2)": "e.$nsp$`0\b4",
		"Adding two inputs": "+Jj"
	};

	var nsp = [];
	var keyz = Object.keys(progs);
	for(var i=0;i<keyz.length;i++){
		nsp.push(progs[keyz[i]]);
	}

	function run(ex){
		document.getElementById("code").value = progs[ex];
	}

	function updateByteCount(){
		document.getElementById("bytes").innerHTML = utf8.encode(document.getElementById("code").value).length;
	}

	function onEdit(){
		document.getElementById("code").value = document.getElementById("code").value.replace(/\\b/g,"\b").replace(/\\n/g,"\n").replace(/\\t/g,"\t").replace(/\\x(..)/g,function(m,p1){return eval("\"\\x"+p1+"\"")});
		updateByteCount();
	}

	function addListeners(){
		document.getElementById("code").addEventListener("change",updateByteCount);
		document.getElementById("code").addEventListener("keydown",updateByteCount);
		document.getElementById("code").addEventListener("keyup",updateByteCount);
		var qS = document.querySelectorAll("#openMenu + div#inner button");
		for(var i=0;i<qS.length;i++){
			qS[i].addEventListener("click",function(){
				document.getElementById("code").value = progs[this.innerHTML] || "XError: program not found";
			});
		}
		document.getElementById("save").addEventListener("click",save);
		document.getElementById("load").addEventListener("click",load);
		document.getElementById("openMenu").addEventListener("click",function(e){
			var inner = document.getElementById("inner");
			inner.style.height = inner.style.height!="auto"?"auto":"0px";
		});
		document.getElementById("run").addEventListener("click",function(){
			var x = new Jolf(document.getElementById("code").value);
			while(x.step());
			x.exec();
			var o;
			try {
				o = x.readable();
			} catch(e){
				o = x.total;
			}
			document.getElementById("outCode").innerHTML = o;
		});
		document.getElementById("runnn").addEventListener("click",function(){
			var x = new Jolf(document.getElementById("code").value);
			while(x.step());
			var o;
			try {
				o = x.readable();
			} catch(e){
				o = x.total;
			}
			document.getElementById("outCode").innerHTML = o;
			document.getElementById("input").value.split("\n\n").forEach(function(e,i){
				document.getElementById("output").innerHTML += "--- TEST CASE "+i+": "+e+" ---<br>";
				x.exec();
				document.getElementById("output").innerHTML += "<br>";
			});
		});
		document.getElementById("transform").addEventListener("click",onEdit);
		document.getElementById("clear").addEventListener("click",function(){document.getElementById("output").innerHTML = "";});
		updateByteCount();
	}

	window.addEventListener("load",load);
	window.addEventListener("load",addListeners);
	</script>
	<link rel="STYLESHEET" href="Jolf.css">
</head>
<body>
<div id="container">
	<header>
		<h1 id="title">Jolf</h1>
		<button class="btn btn-success" id="save">save</button>
		<button class="btn btn-warning" id="load">load</button>
		<div id="menu">
			<button class="btn btn-info" id="openMenu">
				examples
			</button>
			<div id="inner">
				<ul>
					<li><button class="btn btn-info">Hello World (1)</button></li>
					<li><button class="btn btn-info">Hello World (2)</button></li>
					<li><button class="btn btn-info">Adding two inputs</button></li>
				</ul>
			</div>
		</div>
		<a href="explanation.html">explanation</a>
	</header>
	<p>Code (bytes: <span id="bytes">0</span>)</p>
	<textarea id="code" spellcheck="false"></textarea>
	<button id="transform" class="btn btn-info">apply transformation of code</button>
	<p>Input</p>
	<p>Input is seperated by a double newline (<code>\n\n</code>).</p>
	<textarea id="input" spellcheck="false"></textarea>
	<button class="btn btn-block btn-primary sev" id="run">Run (runs the program once)</button>
	<button class="btn btn-block btn-warning sev" id="runnn">Full Run (runs the program once for each input)</button>
	<p>Output</p>
	<div id="output"></div>
	<button id="clear" class="btn btn-block btn-info sev">clear</button>
	<p>Transpiled code</p>
	<div id="outCode"></div>
	<p>Canvas output</p>
	<canvas id="draw"><b>Sorry! It seems that your browser does not support canvs. :( Maybe try <a href="https://www.mozilla.org/en-US/firefox/new/">Firefox</a>? <sub>better than IE and Chrome</sub></b></canvas>
	<div id="options">
		<h2>Options</h2>
		<input type="checkbox" id="pom"> Pretty output mode?
	</div>
</div>
</body>
</html>
